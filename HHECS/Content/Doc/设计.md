# 约定
## 命名约定
* 堆垛机：SRM
* 站台：Station
* 排列层：row,column,layer

## 状态约定
任务创建 = 1,
下发任务 = 10,


//多任务堆垛机状态
下发堆垛机库内取货 = 20,//（开始执行“出”性质任务，去目标库位取出托盘）
响应堆垛机库内取货完成 = 25,//（“出”性质任务完成，此时这个任务对应的托盘在货叉内）
下发堆垛机库外放货 = 30,//（“出”性质任务放到对应接出口）
响应堆垛机库外放货完成 = 35,//（堆垛机将托盘已经放到接出口）
响应接出口站台请求 = 40,//（此时将任务写给站台完毕）
到达拣选站台 = 50,//（响应拣选站台的位置到达）--整出任务直接完成
拣选台回库 = 60,//（模拟电气按钮或是响应地址请求后）
响应接入站台到达 = 70,//可被堆垛机执行入库任务了
下发堆垛机库外取货 = 75,//（指示堆垛机去接入口接托盘）
响应堆垛机库外取货完成 = 80,//（此时堆垛机已经接完托盘，托盘应在货叉内等待去向指令）
下发堆垛机库内放货 = 85,//（此时堆垛机带着托盘去目标库位）--同巷道库内移库任务直接跳到这
响应堆垛机库内放货完成 = 90,	//（此时堆垛机已经将托盘放入了目标货位）

//单任务堆垛机状态
下发堆垛机入库任务 = 91,
下发堆垛机出库任务 = 93,
下发堆垛机库内移库 = 95,
下发堆垛机换站任务 = 98,

任务完成 = 100, //任务完成
//任务回传失败 = 110, //任务回传失败
//任务回传成功 = 120, //任务回传成功
异常结束 = 130,

## 任务类型：
100	整盘入库
500	空容器入库

300	整盘出库
600	空容器出库

200	补充入库
400	分拣出库
700	盘点

800	移库

900 出库查看

1000 换站

## 任务
* 任务本地完成，然后进行回传；
* 堆垛机在完成任务时，更新任务ArrivaEquipmentCode；
* 任务中port作为实际到达最终出口或拣选口；port作为一个逻辑编码，提供与具体的站台设备的映射；编码通过映射来查询具体的设备；映射的配置存于数据字典并受权限管控；具体值视项目而定并与上游约定；通常，在只有一节输送线的情况下，即接出口直接对应着分拣口，则直接设置字典value为接出口code简单点；如果接出口到实际分拣口不止一条路径，则需要实现路由算法，具体视项目而定；
* 任务在空出和取货错的情况下，为异常结束；其他正常结束；
* 默认任务下发状态才能执行；接口生成的任务考虑自动下发；

## 货架和容器
与WMS分离，则货架和容器也需要与WMS分离；提供货架容器的增删改查；

## 仓库
提供仓库作为设备、货架、容器等的基本划分

## 地址示例
### 西门子系列
	* bool(1位):DB11X1.2
	* int(有符号2个字节):DB11INT0
	* dint(有符号4个字节):DB11DINT0
	* word(无符号2个字节):DB11W0
	* dword(无符号4个字节):DB11D0
	* char(字符，ascll码，逗号后面表示长度):DB11CHAR0,20
### 三菱系列（待完善）


##信息的传递
	修正添加了portstockerstation表格用来查找出口站台   根据堆垛机和响应的出入口进行查询

## todo
* 加入心跳检测
* 堆垛机监控图优化
* 日志布局优化
* 站台监控列表优化
* 空出、重入、取货错等异常处理整理

